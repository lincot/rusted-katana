#![feature(test)]

extern crate test;
use test::{black_box, Bencher};

#[bench]
fn bench(bencher: &mut Bencher) {
    let inputs = [
        vec![
            "+--+  +----+",
            "|  |  |    |    +-+",
            "|  |  +----+    | |",
            "+--+            +-+",
        ],
        vec!["+-----+", "|     |", "+-----+"],
        vec!["+-+-+", "| | |", "+-+-+", "| | |", "+-+-+"],
        vec![
            "+---+", "|   |", "|   |", "|   |", "|   |", "|   |", "|   |", "|   |", "+---+",
        ],
        vec!["+---+", "|   |", "|   |", "|   |", "+---+"],
        vec![
            "+---+", "|   |", "|  ++--+", "|  ||  |", "+--++  |", "   |   |", "   +---+",
        ],
        vec![
            "   +---+", "   |   |", "+--++  |", "|  ||  |", "|  ++--+", "|   |", "+---+",
        ],
        vec![
            "+---+",
            "|   |",
            "|   |  +---+",
            "|   |  |   |",
            "+---+  |   |",
            "       |   |",
            "       +---+",
        ],
        vec![
            "+---+---+",
            "|   |   |",
            "|   |   |",
            "|   |   |",
            "+---+---+",
            "|   |   |",
            "|   |   |",
            "|   |   |",
            "+---+---+",
        ],
        vec![
            "+----+--+",
            "|    |  |",
            "|    |  |",
            "|    |  |",
            "+----+--+",
            "|    |  |",
            "|    |  |",
            "|    |  |",
            "+----+--+",
        ],
        vec![
            "+---+---+",
            "|   |   |",
            "|   |   |",
            "|   |   |",
            "|   |   |",
            "+---+---+",
            "|   |   |",
            "|   |   |",
            "+---+---+",
        ],
        vec![
            "+---+---+",
            "|   |   |",
            "| +-+-+ |",
            "| | | | |",
            "+-+-+-+-+",
            "| | | | |",
            "| +-+-+ |",
            "|   |   |",
            "+---+---+",
        ],
        vec![
            "  +---+",
            "  |   |",
            "  |   |  +--+",
            "+-+-+ |  |  |",
            "| +-+-+  |  |",
            "+---+    +--+",
        ],
        vec![
            "+---+",
            "|   |",
            "|   |",
            "+--+|+--+",
            "+--++|  |",
            "+--+-+--+",
            "   | |",
            "   | |",
            "   +-+",
        ],
        vec![
            "+---------+--+",
            "|  +---+  |  |",
            "|  |   |  |  |",
            "|  |   |  +--+",
            "|  |   |     |",
            "|  +---+     |",
            "|            |",
            "|            |",
            "|            |",
            "|            |",
            "|    +---+---+",
            "|    |   |   |",
            "|    |   |   |",
            "+----+---+---+",
            "     +---+",
        ],
        vec!["++", "++"],
        vec!["+"],
        vec![
            "   +--+",
            "   |  |",
            "   |  |",
            "+--+--+--+",
            "|  |  |  |",
            "|  |  |  |",
            "+--+--+--+",
            "   |  |",
            "   |  |",
            "   +--+",
        ],
        vec![
            "+--+  +--+",
            "|  |  |  |",
            "|  |  |  |",
            "+--+--+--+",
            "   |  |",
            "   |  |",
            "+--+--+--+",
            "|  |  |  |",
            "|  |  |  |",
            "+--+  +--+",
        ],
        vec![
            "   +--+  +--+",
            "   |  |  |  |",
            "   |  |  |  |",
            "+--+--+--+--+",
            "|  |  |  |",
            "|  |  |  |",
            "+--+--+--+--+",
            "   |  |  |  |",
            "   |  |  |  |",
            "+--+--+--+--+",
            "|  |  |  |",
            "|  |  |  |",
            "+--+  +--+",
        ],
        vec![
            "+-+ +-+", "| | | |", "+-+ +-+", "", "+-+ +-+", "| | | |", "+-+ +-+",
        ],
        vec![
            "+-+---+", "| |   |", "| |   |", "+-+-+-+", "| | | |", "| | | |", "+-+ +-+",
        ],
        vec![
            "++++++++", "++++++++", "++++++++", "++++++++", "++++++++", "++++++++", "++++++++",
            "++++++++",
        ],
        vec![
            "",
            "    +--+",
            " +--++ |   +-+",
            " |  || |   | |",
            " |  ++-+---+-+",
            " |   | |   |",
            " +---+-+   |",
            "       |   |",
            "       +---+",
            "",
            "+---+",
            "|   |",
            "|   |",
            "|   |",
            "+---+",
        ],
    ];
    let inputs = black_box(&inputs);
    bencher.iter(|| {
        for lines in inputs {
            black_box(solution::count_squares(lines));
        }
    });
}
